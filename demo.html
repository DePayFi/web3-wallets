<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="https://depay.com/favicon.png"/>
    <title>Demo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.css">
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.1/ethers.umd.min.js" type="application/javascript"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@uiw/copy-to-clipboard/dist/copy-to-clipboard.umd.js"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/solana-web3.js@1"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/web3-blockchains@9"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/web3-client@10"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/walletconnect-v2@2"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/coinbase-wallet-sdk@3"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/web3-tokens@10"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/@depay/worldcoin-precompiled@0.0.33"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/qr-code-styling@1"></script>
    <script src="dist/umd/index.js?v=52"></script>
    <style>
      .btn-primary {
        color: #fff;
        background-color: #ea357a !important;
        border: 1px solid #ea357a !important;
        padding: 0.35rem 1.2rem !important;
        box-shadow: none;
        outline: none;
      }
      .btn-primary:hover {
        background-color: #db3071 !important;
      }
    </style>
    <script>

      document.addEventListener("DOMContentLoaded", function() {
        window.eruda.init()
        console.log('v52')
      });

      window.getNonce = async(address)=>{
        
        const getBitmap = (address, word)=>Web3Client.request({
          blockchain: 'worldchain',
          address: '0x000000000022D473030F116dDEE9F6B43aC78BA3',
          api: [{"inputs":[{"internalType":"uint256","name":"deadline","type":"uint256"}],"name":"AllowanceExpired","type":"error"},{"inputs":[],"name":"ExcessiveInvalidation","type":"error"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"InsufficientAllowance","type":"error"},{"inputs":[{"internalType":"uint256","name":"maxAmount","type":"uint256"}],"name":"InvalidAmount","type":"error"},{"inputs":[],"name":"InvalidContractSignature","type":"error"},{"inputs":[],"name":"InvalidNonce","type":"error"},{"inputs":[],"name":"InvalidSignature","type":"error"},{"inputs":[],"name":"InvalidSignatureLength","type":"error"},{"inputs":[],"name":"InvalidSigner","type":"error"},{"inputs":[],"name":"LengthMismatch","type":"error"},{"inputs":[{"internalType":"uint256","name":"signatureDeadline","type":"uint256"}],"name":"SignatureExpired","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint160","name":"amount","type":"uint160"},{"indexed":false,"internalType":"uint48","name":"expiration","type":"uint48"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"address","name":"spender","type":"address"}],"name":"Lockdown","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint48","name":"newNonce","type":"uint48"},{"indexed":false,"internalType":"uint48","name":"oldNonce","type":"uint48"}],"name":"NonceInvalidation","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint160","name":"amount","type":"uint160"},{"indexed":false,"internalType":"uint48","name":"expiration","type":"uint48"},{"indexed":false,"internalType":"uint48","name":"nonce","type":"uint48"}],"name":"Permit","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"word","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"mask","type":"uint256"}],"name":"UnorderedNonceInvalidation","type":"event"},{"inputs":[],"name":"DOMAIN_SEPARATOR","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"},{"internalType":"uint48","name":"nonce","type":"uint48"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint48","name":"newNonce","type":"uint48"}],"name":"invalidateNonces","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"wordPos","type":"uint256"},{"internalType":"uint256","name":"mask","type":"uint256"}],"name":"invalidateUnorderedNonces","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"internalType":"struct IAllowanceTransfer.TokenSpenderPair[]","name":"approvals","type":"tuple[]"}],"name":"lockdown","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"nonceBitmap","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"},{"internalType":"uint48","name":"nonce","type":"uint48"}],"internalType":"struct IAllowanceTransfer.PermitDetails[]","name":"details","type":"tuple[]"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"sigDeadline","type":"uint256"}],"internalType":"struct IAllowanceTransfer.PermitBatch","name":"permitBatch","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"permit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"},{"internalType":"uint48","name":"nonce","type":"uint48"}],"internalType":"struct IAllowanceTransfer.PermitDetails","name":"details","type":"tuple"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"sigDeadline","type":"uint256"}],"internalType":"struct IAllowanceTransfer.PermitSingle","name":"permitSingle","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"permit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct ISignatureTransfer.TokenPermissions","name":"permitted","type":"tuple"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"struct ISignatureTransfer.PermitTransferFrom","name":"permit","type":"tuple"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"requestedAmount","type":"uint256"}],"internalType":"struct ISignatureTransfer.SignatureTransferDetails","name":"transferDetails","type":"tuple"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"permitTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct ISignatureTransfer.TokenPermissions[]","name":"permitted","type":"tuple[]"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"struct ISignatureTransfer.PermitBatchTransferFrom","name":"permit","type":"tuple"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"requestedAmount","type":"uint256"}],"internalType":"struct ISignatureTransfer.SignatureTransferDetails[]","name":"transferDetails","type":"tuple[]"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"permitTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct ISignatureTransfer.TokenPermissions","name":"permitted","type":"tuple"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"struct ISignatureTransfer.PermitTransferFrom","name":"permit","type":"tuple"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"requestedAmount","type":"uint256"}],"internalType":"struct ISignatureTransfer.SignatureTransferDetails","name":"transferDetails","type":"tuple"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"bytes32","name":"witness","type":"bytes32"},{"internalType":"string","name":"witnessTypeString","type":"string"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"permitWitnessTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"struct ISignatureTransfer.TokenPermissions[]","name":"permitted","type":"tuple[]"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"struct ISignatureTransfer.PermitBatchTransferFrom","name":"permit","type":"tuple"},{"components":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"requestedAmount","type":"uint256"}],"internalType":"struct ISignatureTransfer.SignatureTransferDetails[]","name":"transferDetails","type":"tuple[]"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"bytes32","name":"witness","type":"bytes32"},{"internalType":"string","name":"witnessTypeString","type":"string"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"permitWitnessTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"address","name":"token","type":"address"}],"internalType":"struct IAllowanceTransfer.AllowanceTransferDetails[]","name":"transferDetails","type":"tuple[]"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"address","name":"token","type":"address"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"}],
          method: 'nonceBitmap',
          params: [address, word]
        })

        const getFirstUnsetBit = (bitmap)=>{
          for (let i = 0; i < 256; i++) {
            if (bitmap.shr(i).and(1).eq(0)) {
              return i
            }
          }
          return -1
        }

        function buildNonce(word, bitPos) {
          return ethers.BigNumber.from(word).mul(256).add(bitPos)
        }

        let word = 0

        while(word < 1) {
          const bitmap = await getBitmap(address, word)
          if(bitmap.toString() != Web3Blockchains.worldchain.maxInt) {
            const bitPos = getFirstUnsetBit(bitmap)
            if (bitPos >= 0) {
              // Build and return the nonce
              const nonce = buildNonce(word, bitPos)
              return nonce
            }
          }
          word = word+1;
        }
      }

      window.openNativeLink = (href, uri, name, encoded)=>{
        console.log('openNativeLink', href, uri, name, encoded)
        localStorage.setItem('WALLETCONNECT_DEEPLINK_CHOICE', JSON.stringify({ href, name }))
        if(encoded !== false) {
          href = `${href}wc?uri=${encodeURIComponent(uri)}`
        } else {
          href = `${href}wc?uri=${uri}`
        }
        return window.open(href, '_self', 'noreferrer noopener')
      }

    </script>
  </head>
  <body style="background-color: #FAFAFA;">
    <div class="container py-4">
      
      <div class="py-2 pb-3 text-center">
        <a href="https://depay.com" target="_blank">
          <img alt="DePay" class="navbar-logo shadow-sm" src="https://depay.com/logo.svg" style="height: 50px; width: 50px; border-radius: 999px;"/>
        </a>
      </div>
      
      <div class="row px-2">

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">getWallets()</h5>
                <div class="px-4">
                  <div class="text-secondary ">Retrieve all available wallets.</div>
                  <div class="text-secondary ">(check console.log)</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <button class='btn btn-primary' onClick='Web3Wallets.getWallets().then(console.log)'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">wallet.connect()</h5>
                <div class="px-4">
                  <div class="text-secondary pb-2">Connect detected wallet and yield connected account.</div>
                  <select id="connectWallet">
                  </select>
                  <script>
                    document.addEventListener("DOMContentLoaded", function() {
                      let select = document.getElementById('connectWallet')
                      setTimeout(()=>{
                        Web3Wallets.getWallets().then((availableWallets)=>{
                          availableWallets.forEach((wallet, index)=>{
                            let option = document.createElement("option")
                            option.setAttribute('value', index)
                            option.innerHTML = wallet.name
                            select.append(option)
                          })
                        })
                      }, 500)
                    })
                    window.connectWalletViaSelect = async ()=> {
                      let wallets = await Web3Wallets.getWallets()
                      let wallet = wallets[parseInt(document.getElementById("connectWallet").value, 10)]
                      console.log(wallet)
                      let accounts = await wallet.connect()
                      window.wallet = wallet
                      console.log(accounts)
                    }
                  </script>
                </div>
              </div>
              <div class="px-4 pt-3">
                <button class='btn btn-primary' onClick='connectWalletViaSelect()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WorldApp Pay</h5>
                <div class="px-4">
                  <div class="text-secondary">Test WorldApp Pay</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.worldappPay = async()=>{
                    await WorldcoinPrecompiled.MiniKit.install()
                    WorldcoinPrecompiled.MiniKit.commands.pay({
                      reference: '123',
                      to: "0x317D875cA3B9f8d14f960486C0d1D1913be74e90",
                      tokens: [
                        {
                          symbol: "USDCE",
                          token_amount: "100000",
                        },
                      ],
                      description: "This is a test",
                    })
                  }
                </script>
                <button class='btn btn-primary' onClick='worldappPay()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WorldApp Auth</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test WorldApp Auth</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.worldappAuth = async()=>{
                    await WorldcoinPrecompiled.MiniKit.install()
                    const nonce = crypto.randomUUID().replace(/-/g, "")
                     WorldcoinPrecompiled.MiniKit.subscribe(WorldcoinPrecompiled.ResponseEvent.MiniAppWalletAuth, async (payload) => {
                      if (payload.status === "error") {
                        console.log(payload)
                        return
                      } else {
                        console.log(payload)
                      }
                      console.log('WalletAddress', WorldcoinPrecompiled.MiniKit?.walletAddress)
                    });
                    const generateMessageResult = WorldcoinPrecompiled.MiniKit.commands.walletAuth({
                      nonce: nonce,
                      requestId: "0", // Optional
                      expirationTime: new Date(new Date().getTime() + 7 * 24 * 60 * 60 * 1000),
                      notBefore: new Date(new Date().getTime() - 24 * 60 * 60 * 1000),
                      statement:
                        "This is my statement2 and here is a link https://worldcoin.com/apps",
                    });
                    console.log(generateMessageResult)
                  }
                </script>
                <button class='btn btn-primary' onClick='worldappAuth()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WorldApp SendTransaction</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test WorldApp SendTransaction</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.worldappSendTransactionTuple = async()=>{
                    console.log('installed?', await WorldcoinPrecompiled.MiniKit.install())
                    console.log('WorldcoinPrecompiled.MiniKit.isInstalled()', WorldcoinPrecompiled.MiniKit.isInstalled() ? 'true' : 'false')
                    
                    const permitDeadline = Math.floor(Date.now() / 1000) + 30 * 60

                    const ROUTER = "0xC9850b32475f4fdE5c972EA6f967982a3c435D10"

                    const USDCE = '0x79A02482A880bCE3F13e09Da970dC34db4CD24d1'

                    const ZERO_ADDRESS = '0x0000000000000000000000000000000000000000'
                    const ZERO_BYTES = '0x'
                    
                    const PAYMENT_RECEIVER = '0x08B277154218CCF3380CAE48d630DA13462E3950'

                    const amount = 10000

                    console.log('Before nonce', WorldcoinPrecompiled.MiniKit?.walletAddress)
                    const nonce = (await getNonce(WorldcoinPrecompiled.MiniKit?.walletAddress)).toString()
                    console.log('After nonce', nonce)
                    
                    const permitTransfer = {
                        permitted: {
                          token: USDCE,
                          amount: amount.toString(),
                        },
                        nonce: nonce.toString(),
                        deadline: permitDeadline.toString(),
                    }

                    const transferDetails = {
                        to: ROUTER,
                        requestedAmount: amount,
                    }

                    const transferDetailsArgsForm = [
                        transferDetails.to,
                        transferDetails.requestedAmount,
                    ]

                    const paymentDeadline = permitDeadline * 1000; // permitDeadline in ms

                    const sentTransaction = await window.wallet.sendTransaction({
                      blockchain: 'worldchain',
                      to: ROUTER,
                      api: [{"inputs":[{"internalType":"address","name":"_PERMIT2","type":"address"},{"internalType":"address","name":"_FORWARDER","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ExchangeCallFailed","type":"error"},{"inputs":[],"name":"ExchangeCallMissing","type":"error"},{"inputs":[],"name":"ExchangeNotApproved","type":"error"},{"inputs":[],"name":"ForwardingPaymentFailed","type":"error"},{"inputs":[],"name":"InsufficientBalanceInAfterPayment","type":"error"},{"inputs":[],"name":"InsufficientBalanceOutAfterPayment","type":"error"},{"inputs":[],"name":"InsufficientProtocolAmount","type":"error"},{"inputs":[],"name":"NativeFeePaymentFailed","type":"error"},{"inputs":[],"name":"NativePaymentFailed","type":"error"},{"inputs":[],"name":"PaymentDeadlineReached","type":"error"},{"inputs":[],"name":"PaymentToZeroAddressNotAllowed","type":"error"},{"inputs":[],"name":"WrongAmountPaidIn","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"exchange","type":"address"}],"name":"Disabled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"exchange","type":"address"}],"name":"Enabled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferStarted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"deadline","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"feeAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"slippageAmount","type":"uint256"},{"indexed":false,"internalType":"address","name":"tokenInAddress","type":"address"},{"indexed":false,"internalType":"address","name":"tokenOutAddress","type":"address"},{"indexed":false,"internalType":"address","name":"feeReceiverAddress","type":"address"}],"name":"Payment","type":"event"},{"inputs":[],"name":"FORWARDER","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"PERMIT2","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"exchange","type":"address"},{"internalType":"bool","name":"enabled","type":"bool"}],"name":"enable","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"exchanges","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"}],"internalType":"structIDePayRouterV3.Payment","name":"payment","type":"tuple"},{"components":[{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"structIPermit2.TokenPermissions","name":"permitted","type":"tuple"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"structIPermit2.PermitTransferFrom","name":"permitTransferFrom","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"internalType":"structIDePayRouterV3.PermitTransferFromAndSignature","name":"permitTransferFromAndSignature","type":"tuple"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"}],"internalType":"structIDePayRouterV3.Payment","name":"payment","type":"tuple"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"}],"internalType":"structIDePayRouterV3.Payment","name":"payment","type":"tuple"},{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"},{"internalType":"uint48","name":"nonce","type":"uint48"}],"internalType":"structIPermit2.PermitDetails","name":"details","type":"tuple"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"sigDeadline","type":"uint256"}],"internalType":"structIPermit2.PermitSingle","name":"permitSingle","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"pendingOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdraw","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}],
                      method: 'pay',
                      params: {
                        args: [
                          [ // payment
                            amount.toString(), // amountIn
                            amount.toString(), // paymentAmount
                            "0", // feeAmount
                            "0", // protocolAmount
                            paymentDeadline.toString(), // deadline
                            USDCE, // tokenInAddress
                            ZERO_ADDRESS, // exchangeAddress
                            USDCE, // tokenOutAddress
                            PAYMENT_RECEIVER, // paymentReceiverAddress
                            ZERO_ADDRESS, // feeReceiverAddress
                            0, // exchangeType
                            0, // receiverType
                            true, // permit2
                            ZERO_BYTES, // exchangeCallData
                            ZERO_BYTES, // receiverCallData
                          ],
                          [ // permitTransferFromAndSignature
                            [ // permitTransferFrom
                              [ // permitted
                                USDCE, // token
                                amount.toString() // amount
                              ],
                              nonce.toString(), // nonce
                              permitDeadline.toString() // deadline
                            ],
                            "PERMIT2_SIGNATURE_PLACEHOLDER_0"
                          ]
                        ],
                        permit2: {
                          ...permitTransfer,
                          spender: ROUTER,
                        },
                      },
                      value: 0,
                      sent: function(transaction){ console.log('SENT', transaction) },
                      succeeded: function(transaction){ console.log('SUCCEEDED', transaction) },
                      failed: function(transaction, error){ console.log('FAILED', transaction) }
                    })

                    console.log('after sentTransaction', sentTransaction)

                  }
                </script>
                <button class='btn btn-primary' onClick='worldappSendTransactionTuple()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">Test DePay V3 SignatureTransfer</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test DePay V3 SignatureTransfer</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.v3SignatureTransfer = async()=>{
                    
                    const permitDeadline = Math.floor(Date.now() / 1000) + 30 * 60

                    const ROUTER = "0xC9850b32475f4fdE5c972EA6f967982a3c435D10"

                    const USDCE = '0x79A02482A880bCE3F13e09Da970dC34db4CD24d1'

                    const ZERO_ADDRESS = '0x0000000000000000000000000000000000000000'
                    const ZERO_BYTES = '0x'
                    
                    const PAYMENT_RECEIVER = '0x08B277154218CCF3380CAE48d630DA13462E3950'

                    const amount = 10000

                    const nonce = (await getNonce(await window.wallet.account())).toString()

                    const permitTransfer = {
                        permitted: {
                          token: USDCE,
                          amount: amount.toString(),
                        },
                        nonce: nonce.toString(),
                        deadline: permitDeadline.toString(),
                    }

                    const transferDetails = {
                        to: ROUTER,
                        requestedAmount: amount,
                    }

                    const transferDetailsArgsForm = [
                        transferDetails.to,
                        transferDetails.requestedAmount,
                    ]

                    let signature = await window.wallet.sign({
                      types: {
                        EIP712Domain: [
                          { name: "name", type: "string" },
                          { name: "chainId", type: "uint256" },
                          { name: "verifyingContract", type: "address" },
                        ],
                        PermitTransferFrom: [
                          { name: "permitted", type: "TokenPermissions" },
                          { name: "spender", type: "address" },
                          { name: "nonce", type: "uint256" },
                          { name: "deadline", type: "uint256" }
                        ],
                        TokenPermissions: [
                          { name: "token", type: "address" },
                          { name: "amount", type: "uint256" },
                        ]
                      },
                      primaryType: "PermitTransferFrom",
                      domain: {
                        name: "Permit2",
                        chainId: Web3Blockchains.worldchain.networkId,
                        verifyingContract: Web3Blockchains.worldchain.permit2,
                      },
                      message: {
                        permitted: {
                          token: USDCE,
                          amount: amount.toString(),
                        },
                        spender: ROUTER,
                        nonce: nonce.toString(),
                        deadline: permitTransfer.deadline
                      }
                    })
                    console.log('message', {
                      permitted: {
                          token: USDCE,
                          amount: amount.toString(),
                        },
                        spender: ROUTER,
                        nonce: nonce.toString(),
                        deadline: permitTransfer.deadline
                    })

                    const paymentDeadline = permitDeadline * 1000; // permitDeadline in ms

                    await wallet.sendTransaction({ 
                      blockchain: "worldchain", 
                      from: await wallet.account(), 
                      to: ROUTER, 
                      method: "pay", 
                      params: [
                        [ // payment
                          amount.toString(), // amountIn
                          amount.toString(), // paymentAmount
                          "0", // feeAmount
                          "0", // protocolAmount
                          paymentDeadline, // deadline
                          USDCE, // tokenInAddress
                          ZERO_ADDRESS, // exchangeAddress
                          USDCE, // tokenOutAddress
                          PAYMENT_RECEIVER, // paymentReceiverAddress
                          ZERO_ADDRESS, // feeReceiverAddress
                          0, // exchangeType
                          0, // receiverType
                          true, // permit2
                          ZERO_BYTES, // exchangeCallData
                          ZERO_BYTES, // receiverCallData
                        ],
                        [ // permitTransferFromAndSignature
                          [ // permitTransferFrom
                            [ // permitted
                              USDCE, // token
                              amount.toString() // amount
                            ],
                            nonce.toString(), // nonce
                            permitDeadline.toString() // deadline
                          ],
                          signature
                        ]
                      ],
                      api: [{"inputs":[{"internalType":"address","name":"_PERMIT2","type":"address"},{"internalType":"address","name":"_FORWARDER","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ExchangeCallFailed","type":"error"},{"inputs":[],"name":"ExchangeCallMissing","type":"error"},{"inputs":[],"name":"ExchangeNotApproved","type":"error"},{"inputs":[],"name":"ForwardingPaymentFailed","type":"error"},{"inputs":[],"name":"InsufficientBalanceInAfterPayment","type":"error"},{"inputs":[],"name":"InsufficientBalanceOutAfterPayment","type":"error"},{"inputs":[],"name":"InsufficientProtocolAmount","type":"error"},{"inputs":[],"name":"NativeFeePaymentFailed","type":"error"},{"inputs":[],"name":"NativePaymentFailed","type":"error"},{"inputs":[],"name":"PaymentDeadlineReached","type":"error"},{"inputs":[],"name":"PaymentToZeroAddressNotAllowed","type":"error"},{"inputs":[],"name":"WrongAmountPaidIn","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"exchange","type":"address"}],"name":"Disabled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"exchange","type":"address"}],"name":"Enabled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferStarted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"deadline","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"feeAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"slippageAmount","type":"uint256"},{"indexed":false,"internalType":"address","name":"tokenInAddress","type":"address"},{"indexed":false,"internalType":"address","name":"tokenOutAddress","type":"address"},{"indexed":false,"internalType":"address","name":"feeReceiverAddress","type":"address"}],"name":"Payment","type":"event"},{"inputs":[],"name":"FORWARDER","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"PERMIT2","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"exchange","type":"address"},{"internalType":"bool","name":"enabled","type":"bool"}],"name":"enable","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"exchanges","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"}],"internalType":"structIDePayRouterV3.Payment","name":"payment","type":"tuple"},{"components":[{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"internalType":"structIPermit2.TokenPermissions","name":"permitted","type":"tuple"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"structIPermit2.PermitTransferFrom","name":"permitTransferFrom","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"internalType":"structIDePayRouterV3.PermitTransferFromAndSignature","name":"permitTransferFromAndSignature","type":"tuple"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"}],"internalType":"structIDePayRouterV3.Payment","name":"payment","type":"tuple"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"uint256","name":"protocolAmount","type":"uint256"},{"internalType":"uint256","name":"deadline","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"}],"internalType":"structIDePayRouterV3.Payment","name":"payment","type":"tuple"},{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"},{"internalType":"uint48","name":"nonce","type":"uint48"}],"internalType":"structIPermit2.PermitDetails","name":"details","type":"tuple"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"sigDeadline","type":"uint256"}],"internalType":"structIPermit2.PermitSingle","name":"permitSingle","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"pendingOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdraw","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}],
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                    
                  }
                </script>
                <button class='btn btn-primary' onClick='v3SignatureTransfer()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WalletConnect V1 connect</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test connecting WalletConnect V1</div>
                  <div id="walletConnectV1QRCode">
                  </div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.connectWalletConnectV1 = async()=>{
                    wallet = new Web3Wallets.wallets.WalletConnectV1()
                    let account = await wallet.connect({
                      connect: ({ uri })=>{
                        copyTextToClipboard(uri)
                        const qrCode = new QRCodeStyling({
                          width: 300,
                          height: 300,
                          type: "svg",
                          data: uri,
                        });
                        qrCode.append(document.getElementById("walletConnectV1QRCode"));
                      }
                    })
                    console.log('ACCOUNT', account)
                  }
                </script>
                <button class='btn btn-primary' onClick='connectWalletConnectV1()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WalletConnect V1 reconnect</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test connecting WalletConnect V1</div>
                  <div id="walletConnectV1QRCodereconnect">
                  </div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.reconnectWalletConnectV1 = async()=>{
                    wallet = new Web3Wallets.wallets.WalletConnectV1()
                    let account = await wallet.connect({
                      reconnect: true,
                      connect: ({ uri })=>{
                        copyTextToClipboard(uri)
                        const qrCode = new QRCodeStyling({
                          width: 300,
                          height: 300,
                          type: "svg",
                          data: uri,
                        });
                        qrCode.append(document.getElementById("walletConnectV1QRCodereconnect"));
                      }
                    })
                    console.log('ACCOUNT', account)
                  }
                </script>
                <button class='btn btn-primary' onClick='reconnectWalletConnectV1()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WalletConnect V2 connect QR</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test connecting WalletConnect V2</div>
                  <div>
                    <input placeholder="projectId WalletConnect v2" id="walletConnectV2ProjectId" type="text"/>
                  </div>
                  <div>
                    <select id="walletConnectV2WalletName">
                      <option value="">Unknown</option>
                      <option value="Ledger Live">Ledger Live</option>
                      <option value="MetaMask">MetaMask</option>
                      <option value="Uniswap Wallet">Uniswap Wallet</option>
                      <option value="Enjin Wallet">Enjin Wallet</option>
                    </select>
                  </div>
                  <div id="walletConnectV2QRCode">
                  </div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.connectWalletConnectV2 = async()=>{
                    localStorage['depay:wallets:wc2:projectId'] = document.getElementById("walletConnectV2ProjectId").value
                    let wallet = new Web3Wallets.wallets.WalletConnectV2()
                    let account = await wallet.connect({
                      name: document.getElementById("walletConnectV2WalletName").value,
                      connect: ({ uri })=>{
                        copyTextToClipboard(uri)
                        const qrCode = new QRCodeStyling({
                          width: 300,
                          height: 300,
                          type: "svg",
                          data: uri,
                        });
                        qrCode.append(document.getElementById("walletConnectV2QRCode"));
                      }
                    })
                    console.log('ACCOUNT', account)
                    window.wallet = wallet
                  }
                </script>
                <button class='btn btn-primary' onClick='connectWalletConnectV2()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">WalletConnect V2 connect via redirect</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test connecting WalletConnect V2</div>
                  <div>
                    <input placeholder="projectId WalletConnect v2" id="walletConnectV2ProjectIdRedirect" type="text"/>
                  </div>
                  <div>
                    <select id="walletConnectV2ProjectIdHref">
                      <option value="uniswap://">uniswap</option>
                      <option value="ledgerlive://">Ledger Live</option>
                      <option value="metamask://">MetaMask</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.connectWalletConnectV2ViaRedirect = async()=>{
                    localStorage['depay:wallets:wc2:projectId'] = document.getElementById("walletConnectV2ProjectIdRedirect").value
                    const href = document.getElementById("walletConnectV2ProjectIdHref").value
                    let wallet = new Web3Wallets.wallets.WalletConnectV2()
                    let account = await wallet.connect({
                      connect: ({ uri })=>{
                        window.openNativeLink(href, uri, "TEST")
                      }
                    })
                    console.log('ACCOUNT', account)
                    window.wallet = wallet
                  }
                </script>
                <button class='btn btn-primary' onClick='connectWalletConnectV2ViaRedirect()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">Debug window.ethereum</h5>
                <div class="px-4">
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.debugWindowEthereum = async()=>{
                    setTimeout(()=>{document.body.innerHTML = Object.keys(window.ethereum).join(',')}, 500)
                  }
                </script>
                <button class='btn btn-primary' onClick='debugWindowEthereum()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">Debug window.solana</h5>
                <div class="px-4">
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.debugWindowSolana = async()=>{
                    setTimeout(()=>{document.body.innerHTML = Object.keys(window.solana).join(',')}, 500)
                  }
                </script>
                <button class='btn btn-primary' onClick='debugWindowSolana()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">Debug window.phantom</h5>
                <div class="px-4">
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.debugWindowPhantom = async()=>{
                    setTimeout(()=>{document.body.innerHTML = Object.keys(window.phantom).join(',')}, 500)
                  }
                </script>
                <button class='btn btn-primary' onClick='debugWindowPhantom()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">Solana Pay</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test Solana Pay</div>
                  <div id="solanaPayQR">
                  </div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.testSolanaPay = async()=>{
                    wallet = new Web3Wallets.wallets.SolanaPay()
                    let account = await wallet.connect({
                      reconnect: true,
                      connect: ({ uri })=>{
                        copyTextToClipboard(uri)
                        const qrCode = new QRCodeStyling({
                          width: 300,
                          height: 300,
                          type: "svg",
                          data: uri,
                        });
                        qrCode.append(document.getElementById("solanaPayQR"));
                      }
                    })
                    console.log('ACCOUNT', account)
                  }
                </script>
                <button class='btn btn-primary' onClick='testSolanaPay()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div>
                <h5 class="px-4">Coinbase WalletLink connect</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test connecting WalletLink</div>
                  <div id="walletLinkQRCode">
                  </div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.connectWalletLink = async()=>{
                    wallet = new Web3Wallets.wallets.WalletLink()
                    let account = await wallet.connect({
                      connect: ({ uri })=>{
                        copyTextToClipboard(uri)
                        const qrCode = new QRCodeStyling({
                          width: 300,
                          height: 300,
                          type: "svg",
                          data: uri,
                        });
                        qrCode.append(document.getElementById("walletLinkQRCode"));
                      }
                    })
                    console.log('ACCOUNT', account)
                  }
                </script>
                <button class='btn btn-primary' onClick='connectWalletLink()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Connect Solana MWA</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test connecting Solana MWA.</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.connectSolanaMobileWalletAdapter = async()=> {
                    wallet = new Web3Wallets.wallets.SolanaMobileWalletAdapter()
                    let account = await wallet.connect()
                    console.log('account', account)
                    window.wallet = wallet
                  }
                </script>
                <button class='btn btn-primary' onClick='connectSolanaMobileWalletAdapter()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Connected account</h5>
                <div class="px-4">
                  <div class="text-secondary">Provides connected account via wallet</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.account = async()=>{ console.log(await window.wallet.account()) }
                </script>
                <button class='btn btn-primary' onClick='window.account()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Account changed event</h5>
                <div class="px-4">
                  <div class="text-secondary">Executes callback function in case account changes.</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.setupAccountChanged = async function(){
                    window.wallet.on('account', (newAccount)=>{
                      alert(newAccount)
                    })
                    alert('Now change the wallet account!')
                  }
                </script>
                <button class='btn btn-primary' onClick='window.setupAccountChanged()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send simple SOL transfer on Solana</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendSimpleSOLTransfer = async ()=> {
                    console.log('sendSimpleSOLTransfer')
                    window.wallet.sendTransaction({
                      blockchain: "solana",
                      to: "5AcFMJZkXo14r3Hj99iYd1HScPiM4hAcLZf552DfZkxa",
                      from: await window.wallet.account(),
                      value: 0.01,
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendSimpleSOLTransfer()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send Solana instruction(s)</h5>
                <div class="px-4">
                  <div class="text-secondary ">e.g. transfer 1 USDC</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendUSDCSolana = async ()=> {
                    console.log('sendUSDCSolana')
                    let from = await window.wallet.account()
                    window.wallet.sendTransaction({
                      blockchain: "solana",
                      from,
                      instructions: [await Web3Tokens.Token.solana.createTransferInstruction({
                        token: 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v', 
                        amount: '10000',
                        from,
                        to: '5AcFMJZkXo14r3Hj99iYd1HScPiM4hAcLZf552DfZkxa'
                      })],
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendUSDCSolana()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send simple BNB transfer bsc</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendSimpleTransferBsc = async ()=> {
                    console.log('sendSimpleTransferBsc')
                    wallet.sendTransaction({ 
                      blockchain: "bsc",
                      to: "0x08B277154218CCF3380CAE48d630DA13462E3950",
                      value: "10000000000",
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendSimpleTransferBsc()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send simple MATIC transfer polygon</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendSimpleTransferMatic = async ()=> {
                    console.log('sendSimpleTransferMatic')
                    wallet.sendTransaction({ 
                      blockchain: "polygon",
                      to: "0x08B277154218CCF3380CAE48d630DA13462E3950",
                      value: "1000000000000000",
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendSimpleTransferMatic()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send simple ETH transfer ethereum</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendSimpleEthTransfer = async ()=> {
                    console.log('sendSimpleEthTransfer')
                    wallet.sendTransaction({ 
                      blockchain: "ethereum",
                      to: "0x08B277154218CCF3380CAE48d630DA13462E3950",
                      value: "100000000000",
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendSimpleEthTransfer()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send simple BNB transfer into smart contract bsc</h5>
                <div class="px-4">
                  <div class="text-secondary ">Should have elavated gas limit.</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendSimpleTransferBscIntoContract = async ()=> {
                    console.log('sendSimpleTransferBscIntoContract')
                    wallet.sendTransaction({ 
                      blockchain: "bsc",
                      to: "0xb6c3ea7940bb9d99bc968d41e6fa06e07402ed43",
                      from: await wallet.account(),
                      value: "1000000000000000",
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendSimpleTransferBscIntoContract()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send BUSD token transfer bsc</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendContractTransactionBsc = async ()=> {
                    console.log('sendContractTransactionBsc')
                    await wallet.sendTransaction({ 
                      blockchain: "bsc", 
                      from: await wallet.account(), 
                      to: "0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56", 
                      method: "transfer", 
                      params: ["0x317D875cA3B9f8d14f960486C0d1D1913be74e90", "1000000000000000000" ],
                      api: [{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"renounceOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}],
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendContractTransactionBsc()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send USDC token transfer eth</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendContractTransactionEthereum = async ()=> {
                    console.log('sendContractTransactionEthereum')
                    await wallet.sendTransaction({ 
                      blockchain: "ethereum", 
                      from: await wallet.account(), 
                      to: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48", 
                      method: "transfer", 
                      params: ["0x317D875cA3B9f8d14f960486C0d1D1913be74e90", "100" ],
                      api: [{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"constant":true,"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"renounceOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"sender","type":"address"},{"internalType":"address","name":"recipient","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}],
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendContractTransactionEthereum()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send DePayRouter route USDC on polygon</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendRouteOnPolygon = async ()=> {
                    console.log('route on polygon')
                    let account = await wallet.account()
                    await wallet.sendTransaction({ 
                      blockchain: "polygon", 
                      from: account, 
                      to: "0x2CA727BC33915823e3D05fe043d310B8c5b2dC5b", 
                      method: "route", 
                      params: { path: ['0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174'], amounts: ['100000', '100000'], addresses: [account, account], plugins: ['0x78C0F1c712A9AA2004C1F401A7307d8bCB62abBd'], data: [] },
                      api: [{"inputs":[{"internalType":"address","name":"_configuration","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ETH","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"configuration","outputs":[{"internalType":"contract DePayRouterV1Configuration","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pluginAddress","type":"address"}],"name":"isApproved","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"path","type":"address[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"internalType":"address[]","name":"addresses","type":"address[]"},{"internalType":"address[]","name":"plugins","type":"address[]"},{"internalType":"string[]","name":"data","type":"string[]"}],"name":"route","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdraw","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}],
                      value: 0,
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendRouteOnPolygon()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send DePayRouter route MATIC on polygon</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendRouteOnMaticPolygon = async ()=> {
                    console.log('route on polygon')
                    let account = await wallet.account()
                    await wallet.sendTransaction({ 
                      blockchain: "polygon", 
                      from: account, 
                      to: "0x2CA727BC33915823e3D05fe043d310B8c5b2dC5b", 
                      method: "route", 
                      params: { path: ['0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE'], amounts: ['10000000000', '10000000000'], addresses: [account, account], plugins: ['0x78C0F1c712A9AA2004C1F401A7307d8bCB62abBd'], data: [] },
                      api: [{"inputs":[{"internalType":"address","name":"_configuration","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ETH","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"configuration","outputs":[{"internalType":"contract DePayRouterV1Configuration","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"pluginAddress","type":"address"}],"name":"isApproved","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"path","type":"address[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"internalType":"address[]","name":"addresses","type":"address[]"},{"internalType":"address[]","name":"plugins","type":"address[]"},{"internalType":"string[]","name":"data","type":"string[]"}],"name":"route","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdraw","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}],
                      value: '10000000000',
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendRouteOnMaticPolygon()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Send DePayRouter route on bsc</h5>
              </div>
              <div class="px-4 pt-3">
                <script>
                  window.sendRouteOnBSC = async ()=> {
                    console.log('route on bsc')
                    let account = await wallet.account()
                    await wallet.sendTransaction({ 
                      blockchain: "bsc", 
                      from: account, 
                      to: "0x7ea09401db4692a8AEF4111b75bD32AE758f552A", 
                      method: "pay", 
                      params: {
                        payment: {
                          amountIn: 1000000000000000,
                          permit2: false,
                          paymentAmount: 1000000000000000,
                          feeAmount: 0,
                          tokenInAddress: '0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE',
                          exchangeAddress: Web3Blockchains['bsc'].zero,
                          tokenOutAddress: '0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE',
                          paymentReceiverAddress: '0x08B277154218CCF3380CAE48d630DA13462E3950',
                          feeReceiverAddress: Web3Blockchains['bsc'].zero,
                          exchangeType: 0,
                          receiverType: 0,
                          exchangeCallData: Web3Blockchains['bsc'].zero,
                          receiverCallData: Web3Blockchains['bsc'].zero,
                          deadline: 1794587231
                        }
                      },
                      api: [{"inputs":[{"internalType":"address","name":"_PERMIT2","type":"address"},{"internalType":"address","name":"_FORWARDER","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ExchangeCallFailed","type":"error"},{"inputs":[],"name":"ExchangeCallMissing","type":"error"},{"inputs":[],"name":"ExchangeNotApproved","type":"error"},{"inputs":[],"name":"ForwardingPaymentFailed","type":"error"},{"inputs":[],"name":"InsufficientBalanceInAfterPayment","type":"error"},{"inputs":[],"name":"InsufficientBalanceOutAfterPayment","type":"error"},{"inputs":[],"name":"NativeFeePaymentFailed","type":"error"},{"inputs":[],"name":"NativePaymentFailed","type":"error"},{"inputs":[],"name":"PaymentDeadlineReached","type":"error"},{"inputs":[],"name":"PaymentToZeroAddressNotAllowed","type":"error"},{"inputs":[],"name":"WrongAmountPaidIn","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"exchange","type":"address"}],"name":"Disabled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"exchange","type":"address"}],"name":"Enabled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"InternalTransfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferStarted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[],"name":"FORWARDER","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"PERMIT2","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"exchange","type":"address"},{"internalType":"bool","name":"enabled","type":"bool"}],"name":"enable","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"exchanges","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"struct IDePayRouterV2.Payment","name":"payment","type":"tuple"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"components":[{"internalType":"uint256","name":"amountIn","type":"uint256"},{"internalType":"bool","name":"permit2","type":"bool"},{"internalType":"uint256","name":"paymentAmount","type":"uint256"},{"internalType":"uint256","name":"feeAmount","type":"uint256"},{"internalType":"address","name":"tokenInAddress","type":"address"},{"internalType":"address","name":"exchangeAddress","type":"address"},{"internalType":"address","name":"tokenOutAddress","type":"address"},{"internalType":"address","name":"paymentReceiverAddress","type":"address"},{"internalType":"address","name":"feeReceiverAddress","type":"address"},{"internalType":"uint8","name":"exchangeType","type":"uint8"},{"internalType":"uint8","name":"receiverType","type":"uint8"},{"internalType":"bytes","name":"exchangeCallData","type":"bytes"},{"internalType":"bytes","name":"receiverCallData","type":"bytes"},{"internalType":"uint256","name":"deadline","type":"uint256"}],"internalType":"struct IDePayRouterV2.Payment","name":"payment","type":"tuple"},{"components":[{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint160","name":"amount","type":"uint160"},{"internalType":"uint48","name":"expiration","type":"uint48"},{"internalType":"uint48","name":"nonce","type":"uint48"}],"internalType":"struct IPermit2.PermitDetails","name":"details","type":"tuple"},{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"sigDeadline","type":"uint256"}],"internalType":"struct IPermit2.PermitSingle","name":"permitSingle","type":"tuple"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"pay","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"pendingOwner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdraw","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}],
                      value: '1000000000000000',
                      sent: function(transaction){ console.log("sent callback", transaction) },
                      succeeded: function(transaction){ console.log("succeeded callback", transaction) },
                      failed: function(transaction){ console.log("failed callback", transaction) } 
                    }).then((transaction)=>{ console.log('sendTransaction then ->', transaction) })
                  }
                </script>
                <button class='btn btn-primary' onClick='window.sendRouteOnBSC()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Sign message</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test signing a msg through the connected wallet.</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <button class='btn btn-primary' onClick='window.wallet.sign("This is a test message\n\n And a new line").then((signature)=>{console.log(signature)})'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Transaction count</h5>
                <div class="px-4">
                  <div class="text-secondary ">Gets the transaction count for the connected wallet.</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <button class='btn btn-primary' onClick='window.wallet.transactionCount({ blockchain: "worldcoin", address: WorldcoinPrecompiled.MiniKit?.walletAddress }).then((number)=>{console.log(`Transaction Count: ${number.toString()}`)})'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Sign typed data</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test signing typed data with the connected wallet.</div>
                </div>
              </div>
              <div class="px-4 pt-3">
                <script>
                    window.signTypedData = async ()=> {
                      console.log('signTypedData')

                      let signature = await window.wallet.sign({
                        types: {
                          Domain: [
                            { name: "name", type: "string" },
                            { name: "version", type: "string" },
                            { name: "chainId", type: "uint256" },
                            { name: "verifyingContract", type: "address" }
                          ],
                          PermitSingle: [
                            { name: "details", type: "PermitDetails" },
                            { name: "spender", type: "address" },
                            { name: "sigDeadline", type: "uint256" }
                          ],
                          PermitDetails: [
                            { name: "token", type: "address" },
                            { name: "amount", type: "uint160" },
                            { name: "expiration", type: "uint48" },
                            { name: "nonce", type: "uint48" }
                          ]
                        },
                        primaryType: "PermitSingle",
                        domain: {
                          chainId: 1,
                          name: "Permit2",
                          verifyingContract: "0x000000000022d473030f116ddee9f6b43ac78ba3",
                          version: "1"
                        },
                        message: {
                          details: {
                            token: "0xaf88d065e77c8cC2239327C5EDb3A432268e5831",
                            amount: "1461501637330902918203684832716283019655932542975",
                            expiration: Math.floor(Date.now() / 1000) + 86400,
                            nonce: 0
                          },
                          spender: "0x000000000022d473030f116ddee9f6b43ac78ba3",
                          sigDeadline: Math.floor(Date.now() / 1000) + 86400
                        }
                      })
                      console.log('signature', signature)
                    }
                  </script>
                <button class='btn btn-primary' onClick='window.signTypedData()'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Switch network</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test switching network.</div>
                  <select id="switchingNetwork">
                    <option value="ethereum">Ethereum</option>
                    <option value="bsc">BSC</option>
                    <option value="polygon">Polygon</option>
                    <option value="velas">Velas</option>
                  </select>
                </div>
              </div>
              <div class="px-4 pt-3">
                <button class='btn btn-primary' onClick='window.wallet.switchTo(document.getElementById("switchingNetwork").value).then((value)=>{console.log("SWITCHED", value)}).catch((error)=>{ console.log(error) })'>Try it</button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-md-inline-block p-2 col-12 col-md-4">
          <div class="px-0 py-4 rounded-lg bg-white border">
            <div class="col px-0">
              <div class="overflow-auto" style="height: 120px;">
                <h5 class="px-4">Add network</h5>
                <div class="px-4">
                  <div class="text-secondary ">Test adding network.</div>
                  <select id="addingNetwork">
                    <option value="ethereum">Ethereum</option>
                    <option value="bsc">BSC</option>
                    <option value="polygon">Polygon</option>
                    <option value="velas">Velas</option>
                  </select>
                </div>
              </div>
              <div class="px-4 pt-3">
                <button class='btn btn-primary' onClick='window.wallet.addNetwork(document.getElementById("addingNetwork").value).then((value)=>{console.log("ADDED", value)}).catch((error)=>{ console.log(error) })'>Try it</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </body>
</html>
